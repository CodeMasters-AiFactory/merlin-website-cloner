{
  "project": "Merlin Website Cloner",
  "linear_project_id": "0ece2f30-0273-4635-aa00-06dcfb79b201",
  "linear_url": "https://linear.app/code-masters/project/merlin-website-cloner-0102a6dc2777",
  "last_updated": "2025-12-22T11:45:00Z",
  "total_features": 42,
  "completed_features": 18,
  "features": [
    {
      "id": "COD-11-001",
      "linear_issue": "COD-11",
      "category": "security",
      "priority": "urgent",
      "description": "Move JWT secret from hardcoded value to environment variable",
      "file": "src/server/auth.ts",
      "steps": ["Locate hardcoded JWT_SECRET in auth.ts", "Replace with process.env.JWT_SECRET", "Add JWT_SECRET to .env.example", "Add validation to fail startup if JWT_SECRET not set", "Test authentication still works"],
      "passes": true
    },
    {
      "id": "COD-11-002",
      "linear_issue": "COD-11",
      "category": "security",
      "priority": "urgent",
      "description": "Replace simple hash with bcrypt for password hashing",
      "file": "src/server/auth.ts",
      "steps": ["Install bcrypt package", "Replace hashPassword to use bcrypt.hash with salt 12", "Replace comparePassword to use bcrypt.compare", "Test login/register works"],
      "passes": true
    },
    {
      "id": "COD-11-003",
      "linear_issue": "COD-11",
      "category": "security",
      "priority": "urgent",
      "description": "Add rate limiting to API endpoints",
      "file": "src/server/index.ts",
      "steps": ["Install express-rate-limit", "Create rate limit middleware (100 req/15min)", "Stricter limit on auth (10/15min)", "Limit clone endpoints (20/hour)", "Test limits work"],
      "passes": true
    },
    {
      "id": "COD-11-004",
      "linear_issue": "COD-11",
      "category": "security", 
      "priority": "urgent",
      "description": "Configure CORS to restrict allowed origins",
      "file": "src/server/index.ts",
      "steps": ["Add ALLOWED_ORIGINS env var", "Configure CORS with specific origins", "Test frontend connects", "Verify random origins blocked"],
      "passes": true
    },
    {
      "id": "COD-11-005",
      "linear_issue": "COD-11",
      "category": "security",
      "priority": "urgent",
      "description": "Add input validation for clone URLs",
      "file": "src/server/services/websiteCloner.ts",
      "steps": ["Install validator package", "Add URL validation", "Block private IPs/localhost", "Block dangerous protocols", "Test validation"],
      "passes": true
    },
    {
      "id": "COD-11-006",
      "linear_issue": "COD-11",
      "category": "security",
      "priority": "urgent",
      "description": "Add Helmet.js for security headers",
      "file": "src/server/index.ts",
      "steps": ["Install helmet", "Add helmet middleware", "Configure CSP", "Test headers set", "Verify app works"],
      "passes": true
    },
    {
      "id": "COD-9-001",
      "linear_issue": "COD-9",
      "category": "database",
      "priority": "high",
      "description": "Install and configure Prisma ORM",
      "file": "package.json",
      "steps": ["npm install prisma @prisma/client", "npx prisma init", "Configure DATABASE_URL in .env", "Verify prisma folder created"],
      "passes": false
    },
    {
      "id": "COD-9-002",
      "linear_issue": "COD-9",
      "category": "database",
      "priority": "high",
      "description": "Create User model in Prisma schema",
      "file": "prisma/schema.prisma",
      "steps": ["Define User model with id, email, password, createdAt", "Add subscription tier field", "Add usage tracking fields", "Run prisma generate"],
      "passes": false
    },
    {
      "id": "COD-9-003",
      "linear_issue": "COD-9",
      "category": "database",
      "priority": "high",
      "description": "Create CloneJob model in Prisma schema",
      "file": "prisma/schema.prisma",
      "steps": ["Define CloneJob model with id, url, status, userId", "Add progress and result fields", "Add relation to User", "Run prisma generate"],
      "passes": false
    },
    {
      "id": "COD-9-004",
      "linear_issue": "COD-9",
      "category": "database",
      "priority": "high",
      "description": "Create Transaction model for payments",
      "file": "prisma/schema.prisma",
      "steps": ["Define Transaction model", "Link to User", "Add Stripe fields", "Run prisma generate"],
      "passes": false
    },
    {
      "id": "COD-9-005",
      "linear_issue": "COD-9",
      "category": "database",
      "priority": "high",
      "description": "Create and run initial migration",
      "file": "prisma/migrations",
      "steps": ["npx prisma migrate dev --name init", "Verify tables created", "Check migration files"],
      "passes": false
    },
    {
      "id": "COD-9-006",
      "linear_issue": "COD-9",
      "category": "database",
      "priority": "high",
      "description": "Create Prisma client singleton",
      "file": "src/server/database.ts",
      "steps": ["Create prisma client instance", "Add connection pooling config", "Export for use in services", "Test connection"],
      "passes": false
    },
    {
      "id": "COD-9-007",
      "linear_issue": "COD-9",
      "category": "database",
      "priority": "high",
      "description": "Migrate user operations to Prisma",
      "file": "src/server/auth.ts",
      "steps": ["Replace in-memory user storage", "Use prisma.user.create for registration", "Use prisma.user.findUnique for login", "Test auth flow"],
      "passes": false
    },
    {
      "id": "COD-9-008",
      "linear_issue": "COD-9",
      "category": "database",
      "priority": "high",
      "description": "Migrate job operations to Prisma",
      "file": "src/server/services/jobManager.ts",
      "steps": ["Replace in-memory job storage", "Use prisma for job CRUD", "Update job status methods", "Test job tracking"],
      "passes": false
    },
    {
      "id": "COD-10-001",
      "linear_issue": "COD-10",
      "category": "payments",
      "priority": "high",
      "description": "Configure Stripe SDK properly",
      "file": "src/server/services/paymentService.ts",
      "steps": ["Verify Stripe keys in env", "Initialize Stripe with API version", "Add error handling", "Test Stripe connection"],
      "passes": true
    },
    {
      "id": "COD-10-002",
      "linear_issue": "COD-10",
      "category": "payments",
      "priority": "high",
      "description": "Create Stripe checkout session endpoint",
      "file": "src/server/routes/payments.ts",
      "steps": ["Create POST /api/checkout endpoint", "Generate checkout session with price", "Return session URL", "Test checkout flow"],
      "passes": true
    },
    {
      "id": "COD-10-003",
      "linear_issue": "COD-10",
      "category": "payments",
      "priority": "high",
      "description": "Set up Stripe webhook endpoint",
      "file": "src/server/routes/webhooks.ts",
      "steps": ["Create POST /api/webhooks/stripe", "Verify webhook signature", "Parse event types", "Add raw body parser"],
      "passes": true
    },
    {
      "id": "COD-10-004",
      "linear_issue": "COD-10",
      "category": "payments",
      "priority": "high",
      "description": "Handle checkout.session.completed webhook",
      "file": "src/server/routes/webhooks.ts",
      "steps": ["Extract customer and subscription data", "Update user subscription tier", "Record transaction in database", "Send confirmation email"],
      "passes": true
    },
    {
      "id": "COD-10-005",
      "linear_issue": "COD-10",
      "category": "payments",
      "priority": "high",
      "description": "Handle subscription.updated webhook",
      "file": "src/server/routes/webhooks.ts",
      "steps": ["Detect plan changes", "Update user tier accordingly", "Handle upgrades/downgrades", "Log changes"],
      "passes": true
    },
    {
      "id": "COD-10-006",
      "linear_issue": "COD-10",
      "category": "payments",
      "priority": "high",
      "description": "Handle subscription.deleted webhook",
      "file": "src/server/routes/webhooks.ts",
      "steps": ["Detect cancellation", "Downgrade user to free tier", "Update database", "Send notification"],
      "passes": true
    },
    {
      "id": "COD-10-007",
      "linear_issue": "COD-10",
      "category": "payments",
      "priority": "high",
      "description": "Enforce page limits based on subscription",
      "file": "src/server/services/websiteCloner.ts",
      "steps": ["Check user tier before clone", "Apply page limits per tier", "Return error if exceeded", "Show upgrade prompt"],
      "passes": true
    },
    {
      "id": "COD-10-008",
      "linear_issue": "COD-10",
      "category": "payments",
      "priority": "high",
      "description": "Create billing portal endpoint",
      "file": "src/server/routes/payments.ts",
      "steps": ["Create GET /api/billing-portal", "Generate Stripe portal session", "Return portal URL", "Test portal access"],
      "passes": true
    },
    {
      "id": "COD-12-001",
      "linear_issue": "COD-12",
      "category": "devops",
      "priority": "high",
      "description": "Create Dockerfile for backend",
      "file": "Dockerfile",
      "steps": ["Use Node 20 alpine base", "Copy package files", "Install dependencies", "Copy source code", "Set CMD to start server"],
      "passes": false
    },
    {
      "id": "COD-12-002",
      "linear_issue": "COD-12",
      "category": "devops",
      "priority": "high",
      "description": "Create docker-compose.yml",
      "file": "docker-compose.yml",
      "steps": ["Define app service", "Add PostgreSQL service", "Add Redis service", "Configure volumes", "Set up networking"],
      "passes": false
    },
    {
      "id": "COD-12-003",
      "linear_issue": "COD-12",
      "category": "devops",
      "priority": "high",
      "description": "Create GitHub Actions test workflow",
      "file": ".github/workflows/test.yml",
      "steps": ["Trigger on PR and push", "Set up Node.js", "Install dependencies", "Run linting", "Run tests"],
      "passes": false
    },
    {
      "id": "COD-12-004",
      "linear_issue": "COD-12",
      "category": "devops",
      "priority": "high",
      "description": "Create GitHub Actions build workflow",
      "file": ".github/workflows/build.yml",
      "steps": ["Build Docker image", "Push to registry", "Tag with commit SHA", "Cache layers"],
      "passes": false
    },
    {
      "id": "COD-12-005",
      "linear_issue": "COD-12",
      "category": "devops",
      "priority": "high",
      "description": "Create GitHub Actions deploy workflow",
      "file": ".github/workflows/deploy.yml",
      "steps": ["Deploy to staging on merge", "Run smoke tests", "Manual approval for prod", "Deploy to production"],
      "passes": false
    },
    {
      "id": "COD-14-001",
      "linear_issue": "COD-14",
      "category": "legal",
      "priority": "high",
      "description": "Enforce robots.txt by default",
      "file": "src/server/services/robotsTxtParser.ts",
      "steps": ["Fetch robots.txt before clone", "Parse disallowed paths", "Block crawling disallowed URLs", "Add override option for site owners"],
      "passes": true
    },
    {
      "id": "COD-14-002",
      "linear_issue": "COD-14",
      "category": "legal",
      "priority": "high",
      "description": "Add rate limiting per domain",
      "file": "src/server/services/websiteCloner.ts",
      "steps": ["Track requests per domain", "Implement delay between requests", "Respect Crawl-delay directive", "Default to 1 second delay"],
      "passes": true
    },
    {
      "id": "COD-14-003",
      "linear_issue": "COD-14",
      "category": "legal",
      "priority": "high",
      "description": "Add user consent recording",
      "file": "src/server/services/consentService.ts",
      "steps": ["Create consent model", "Record user acceptance of ToS", "Store timestamp and IP", "Require consent before clone"],
      "passes": false
    },
    {
      "id": "COD-14-004",
      "linear_issue": "COD-14",
      "category": "legal",
      "priority": "high",
      "description": "Strengthen Terms of Service",
      "file": "frontend/src/pages/Terms.tsx",
      "steps": ["Add backup-only usage clause", "Add copyright disclaimer", "Add DMCA process", "Require checkbox acceptance"],
      "passes": true
    },
    {
      "id": "COD-14-005",
      "linear_issue": "COD-14",
      "category": "legal",
      "priority": "high",
      "description": "Implement DMCA takedown process",
      "file": "src/server/routes/dmca.ts",
      "steps": ["Create DMCA report endpoint", "Add admin notification", "Create takedown workflow", "Document process"],
      "passes": false
    },
    {
      "id": "COD-13-001",
      "linear_issue": "COD-13",
      "category": "testing",
      "priority": "medium",
      "description": "Set up Vitest properly",
      "file": "vitest.config.ts",
      "steps": ["Configure vitest", "Set up test environment", "Add coverage reporting", "Configure thresholds"],
      "passes": false
    },
    {
      "id": "COD-13-002",
      "linear_issue": "COD-13",
      "category": "testing",
      "priority": "medium",
      "description": "Add unit tests for auth service",
      "file": "tests/unit/auth.test.ts",
      "steps": ["Test password hashing", "Test JWT generation", "Test JWT verification", "Test login flow", "Achieve 80% coverage"],
      "passes": false
    },
    {
      "id": "COD-13-003",
      "linear_issue": "COD-13",
      "category": "testing",
      "priority": "medium",
      "description": "Add unit tests for websiteCloner",
      "file": "tests/unit/websiteCloner.test.ts",
      "steps": ["Test URL validation", "Test page limit enforcement", "Test asset extraction", "Mock Puppeteer calls"],
      "passes": false
    },
    {
      "id": "COD-13-004",
      "linear_issue": "COD-13",
      "category": "testing",
      "priority": "medium",
      "description": "Add integration tests for API",
      "file": "tests/integration/api.test.ts",
      "steps": ["Test auth endpoints", "Test clone endpoints", "Test payment endpoints", "Use supertest"],
      "passes": false
    },
    {
      "id": "COD-13-005",
      "linear_issue": "COD-13",
      "category": "testing",
      "priority": "medium",
      "description": "Add E2E tests with Playwright",
      "file": "tests/e2e/clone.spec.ts",
      "steps": ["Install Playwright", "Test full clone workflow", "Test user registration", "Test payment flow"],
      "passes": false
    },
    {
      "id": "COD-13-006",
      "linear_issue": "COD-13",
      "category": "testing",
      "priority": "medium",
      "description": "Set up pre-commit hooks",
      "file": ".husky/pre-commit",
      "steps": ["Install husky", "Add lint-staged", "Run tests before commit", "Block commits on failure"],
      "passes": false
    }
  ]
}
